//  This macro will get slice Label while holding "Shift", //And will show slice Label to Result window//ctrl+click will create sub stack from Result////Wrote by Hideo Otsuna, July 23 2015 Copyright Hideo OtsunaIJ.deleteRows(1, nResults);//print(" ");setResult("Slice No", 0, 0);updateResults();shift=1;ctrl=2; rightButton=4;alt=8;command=20;leftButton=16;insideROI = 32; // requires 1.42i or laterresultn=0;logOpened = false;Origi=getTitle();if (getVersion>="1.37r")	setOption("DisablePopupMenu", true);ResultArray=newArray(nSlices);LabelArray=newArray(nSlices);while ( isOpen("Results")) {//!logOpened ||	getCursorLoc(x, y, z, flags);				if (flags&leftButton!=0){		if (flags&shift!=0){ /////shift			//		print(getInfo("slice.label"));			//oo=getInfo("slice.label");			subtitle=getTitle();						if(subtitle==Origi){				slicenumber=getSliceNumber;				nameposi=getInfo("slice.label");							resultn=nResults;											setResult(Origi, resultn, nameposi);				setResult("Slice No", resultn, getSliceNumber);				updateResults();				wait(800);			}		}		if (flags&ctrl!=0){			showStatus("Creating Stack");			op=isOpen("Sub_"+Origi+".tif");			if(op==1){				selectWindow("Sub_"+Origi+".tif");				close();			}						if(nResults>1){				getDimensions(width2, height2, channels, slices, frames);				newImage("Sub_"+Origi+".tif", "RGB black", width2, height2, 1);									setBatchMode(true);				for(numresult=1; numresult<nResults; numresult++){											prog=nResults/numresult;					showProgress(prog);					name4=getResultString(Origi, numresult);					sliceNo=getResult("Slice No", numresult);											if(sliceNo==0){						sliceNo=getResult("Slice No", numresult+1);						name4=getResultString(Origi, numresult+1);						numresult=numresult+1;					}					realname=name4;						//		name5length=lengthOf(name5);												//		position=indexOf(name5, "_");						//			if(position!=-1){						//	//			name4=substring(name5, position+1, name5length);						//				sliceNo=substring(name5, 0, position);						//				sliceNo=round(sliceNo);						//			}												//sliceNo=List.get("Positive"+numresult);						//		sliceNo=ResultArray[numresult];											selectWindow(Origi);					setSlice(sliceNo);											run("Select All");					run("Copy");											selectWindow("Sub_"+Origi+".tif");					run("Paste");					setMetadata("Label", realname);					run("Add Slice");				}										run("Delete Slice");					setSlice(1);										selectWindow("Sub_"+Origi+".tif");					setBatchMode(false);					updateDisplay();								}			wait(2000);			}			//		}	}// left button}if (getVersion>="1.37r")setOption("DisablePopupMenu", false);